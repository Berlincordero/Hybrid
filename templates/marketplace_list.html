{% extends 'base.html' %}
{% load static i18n %}

{% block title %}
  {% trans "Inicio" %} - Mi Red Social
{% endblock %}

{% block extra_head %}
  <!-- Si requieres incluir CSS o scripts extra en la cabecera -->
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
{% endblock %}

{% block content %}
  

    <!-- Encabezado con Título y botones -->
    <header class="flex items-center justify-between mb-6">
      <h1 class="text-3xl font-bold">{% trans "MarketSide" %}</h1>
      <div class="flex items-center space-x-4">
        <!-- Botón Vender Producto -->
        <a
          href="{% url 'producto_create' %}"
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded transition"
        >
          {% trans "Vender Producto" %}
        </a>
        <!-- Botón Subastas (con color vino oscuro) -->
        <a
        href="{% url 'listar_subastas' %}"
        class="bg-red-900 hover:bg-red-800 text-white font-semibold px-4 py-2 rounded transition"
      >
        {% trans "Subastas" %}
      </a>
      
      </div>
    </header>

    <!-- Sección de productos -->
    <section class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
      {% if productos %}
        {% for producto in productos %}
          <div class="bg-gray-800 shadow rounded overflow-hidden p-2">
            <!-- Imágenes (se muestran todas las imágenes relacionadas) -->
            {% if producto.imagen %}
              <img
                src="{{ producto.imagen.url }}"
                alt="{{ producto.titulo }}"
                class="w-full h-48 object-cover mb-2"
              />
            {% else %}
              <img
                src="{% static 'merketplace/default-product.jpg' %}"
                alt="{% trans 'Sin imagen' %}"
                class="w-full h-48 object-cover mb-2"
              />
            {% endif %}
            {% for img in producto.imagenes.all %}
              <img
                src="{{ img.imagen.url }}"
                alt="{{ producto.titulo }} imagen"
                class="w-full h-32 object-cover mb-1"
              />
            {% endfor %}

            <div class="p-2">
              <h2 class="text-xl font-semibold">{{ producto.titulo }}</h2>
              <p class="text-gray-400 text-sm">
                {% trans "Precio:" %} {{ producto.moneda }} {{ producto.precio }}
              </p>
              <p class="text-gray-300 text-sm">
                {{ producto.descripcion|truncatewords:20 }}
              </p>
              <p class="text-xs text-gray-500">
                {% trans "Vendido por" %} {{ producto.vendedor.username }}
              </p>

              <!-- Datos específicos si la categoría es Ganado -->
              {% if producto.categoria == 'ganado' %}
                <div class="mt-2">
                  <p class="text-sm">
                    <strong>{% trans "Tipo:" %}</strong> {{ producto.get_tipo_ganado_display }}
                  </p>
                  <p class="text-sm">
                    <strong>{% trans "Raza:" %}</strong> {{ producto.raza }}
                  </p>
                  <p class="text-sm">
                    <strong>{% trans "Edad:" %}</strong> {{ producto.edad }}
                  </p>
                </div>
              {% endif %}

              <!-- Videos -->
              {% for video in producto.videos.all %}
                <div class="mt-2">
                  <video controls class="w-full h-auto">
                    <source src="{{ video.video.url }}" type="video/mp4" />
                    {% trans "Tu navegador no soporta la etiqueta de video." %}
                  </video>
                </div>
              {% endfor %}

              <!-- Otros datos -->
              <p class="text-sm mt-2">
                <strong>{% trans "Ubicación:" %}</strong> {{ producto.ubicacion }}
              </p>
              <p class="text-sm">
                <strong>{% trans "Teléfono:" %}</strong> {{ producto.telefono }}
              </p>
              <p class="text-sm">
                <strong>{% trans "Whatsapp:" %}</strong> {{ producto.whatsapp }}
              </p>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="text-gray-400">{% trans "No hay productos en venta." %}</p>
      {% endif %}
    </section>
  </div>
{% endblock %}
