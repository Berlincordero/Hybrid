{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}
  {% trans "Videos" %} - Medios
{% endblock %}

{% block extra_head %}
  <!-- Incluye los estilos de TailwindCSS u otros elementos necesarios en el head -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
  <div class="container mx-auto p-4">
    
    <!-- Encabezado -->
    <header class="flex flex-col sm:flex-row items-center justify-between mb-6 space-y-4 sm:space-y-0">
      <h1 class="text-3xl font-bold">{% trans "VideoPlaces" %}</h1>
      <!-- Enlace para subir video -->
      <a href="{% url 'video_upload' %}" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded transition">
        {% trans "Subir Video" %}
      </a>
    </header>
    
    <!-- NUEVO: Top 10 Videos más reproducidos -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Top 10 Videos más reproducidos</h2>
      <!-- 
        En móviles se mostrará en 1 columna,
        en pantallas pequeñas (sm) en 2 columnas,
        en mediano (md) en 3 columnas,
        en grande (lg) en 4 columnas.
      -->
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in top_videos_reproducidos %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <!-- Ajustamos la altura del video: h-56 en móvil y h-48 para pantallas sm en adelante -->
              <video controls class="w-full h-80 sm:h-64 md:h-56 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}<br>
              <strong>Vistas:</strong> {{ video.vistas }}
            </p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- NUEVO: Top 10 Videos con más estrellas -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Top 10 Videos con más estrellas</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in top_videos_estrellas %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}<br>
              <strong>Estrellas:</strong> {{ video.estrellas }}
            </p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- NUEVO: Mejores blogers (Top 10) -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Mejores Blogers (Top 10)</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in top_bloger_videos %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}<br>
              <strong>Estrellas:</strong> {{ video.estrellas }}<br>
              <strong>Vistas:</strong> {{ video.vistas }}
            </p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos de bloger." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- NUEVO: Categorías agrupadas -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Noticias, Consejos y Cursos</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in noticias_consejos_cursos %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}
            </p>
            <p class="text-xs text-gray-500">{% trans "Subido el" %} {{ video.created_at|date:"d/m/Y H:i" }}</p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos en estas categorías." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- Bloger -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Bloger</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in bloger %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}
            </p>
            <p class="text-xs text-gray-500">{% trans "Subido el" %} {{ video.created_at|date:"d/m/Y H:i" }}</p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos bloger." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- Publicitario y Servicios Profesionales -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Publicitario y Servicios Profesionales</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in publicitario_servprof %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}
            </p>
            <p class="text-xs text-gray-500">{% trans "Subido el" %} {{ video.created_at|date:"d/m/Y H:i" }}</p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos publicitarios o de servicios profesionales." %}</p>
        {% endfor %}
      </div>
    </section>
    
    <!-- Personales -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Personales</h2>
      <div class="grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3">
        {% for video in personal %}
          <div class="bg-gray-800 shadow p-4 rounded">
            <div class="mb-2">
              <video controls class="w-full h-56 sm:h-48 object-cover" poster="{% static 'medios/default-thumbnail.jpg' %}">
                <source src="{{ video.video_file.url }}" type="video/mp4">
                {% trans "Tu navegador no soporta videos HTML5." %}
              </video>
            </div>
            <h2 class="text-lg font-semibold mb-1">{{ video.titulo }}</h2>
            <p class="text-sm text-gray-400 mb-1">
              {% trans "Por" %} {{ video.autor.username }}
            </p>
            <p class="text-xs text-gray-500">{% trans "Subido el" %} {{ video.created_at|date:"d/m/Y H:i" }}</p>
            <a href="{% url 'video_detail' video.pk %}" class="text-blue-400 hover:underline">
              Ver Detalles
            </a>
          </div>
        {% empty %}
          <p class="text-gray-400">{% trans "No hay videos personales." %}</p>
        {% endfor %}
      </div>
    </section>
    
  </div>

  <!-- Script para ajustar las imágenes vía JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Selecciona todas las imágenes con clase 'foro-image'
      const images = document.querySelectorAll('.foro-image');
      images.forEach((img) => {
        img.style.objectFit = 'contain';
        img.style.width = '100%';
        img.style.display = 'block';
        img.style.margin = '0 auto';
      });
    });
  </script>
{% endblock %}
